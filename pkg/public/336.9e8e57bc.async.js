"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[336],{81737:function(G,I,e){e.d(I,{Fp:function(){return W},sV:function(){return a}});var O=e(54306),r=e.n(O),g=e(62086),l=e(93236),y=e(21140),P=e.n(y),b=e(63466),_=e.n(b),m=e(57810),d;(function(c){c.QUERY="Query",c.MSG="Msg",c.CONNECTION_BROADCAST="ConnectionBroadcast",c.DISCONNECTION_BROADCAST="DisconnectionBroadcast",c.QUERY_RESPONSE="QueryResponse",c.NATIVE_API_RESPONSE="NativeAPIResponse",c.NATIVE_API_RESPONSE_ASYNC="NativeAPIResponse_Async",c.WEB_API_RESPONSE="WebAPIResponse"})(d||(d={}));var C=function(){function c(n){P()(this,c);var t;console.log("AirtSocketClient constructor");var o=n.hostname,s=o===void 0?(t=window.location.hostname)!==null&&t!==void 0?t:"127.0.0.1":o,u=n.port,i=u===void 0?"8040":u,E=n.namespace,f=E===void 0?"/AIRT":E,A=n.UserRole,h=n.UserGroup,v=h===void 0?"AirtChannel":h;this.UserRole=A,this.config=n,this.entities=new Map,this.socket=m.ZP("http://".concat(s,":").concat(i).concat(f),{query:{UserRole:A,UserGroup:v},transports:["websocket"]}),this.onWebAPI(),this.onQuery(),this.initDevtool()}return _()(c,[{key:"initDefaultConfig",value:function(){this.config=Object.assign(this.config,this.getDefaultConfig())}},{key:"getDefaultConfig",value:function(){var t;return{hostname:(t=window.location.hostname)!==null&&t!==void 0?t:"127.0.0.1",port:"8040",namespace:"/AIRT",UserGroup:"AirtChannel",devtool:!1}}},{key:"initSocketIO",value:function(){var t=this.config,o=t.hostname,s=t.port,u=t.namespace,i=t.UserRole,E=t.UserGroup,f="http://".concat(o,":").concat(s).concat(u);this.socket=m.ZP(f,{query:{UserRole:i,UserGroup:E},transports:["websocket"]})}},{key:"registerEntity",value:function(t,o){this.entities.set(t,o)}},{key:"getEntity",value:function(t){return this.entities.get(t)}},{key:"formatLog",value:function(t,o){this.config.devtool&&console.log("%c[AirtSocketClientDevLog  ".concat(t,"]"),"color: darkred;",o)}},{key:"initDevtool",value:function(){var t=this;this.onConnect(function(o){return t.formatLog("onConnect",o)}),this.onDisconnect(function(o){return t.formatLog("onDisconnect",o)}),this.onWebAPIResponse(function(o){return t.formatLog("onWebAPIResponse",o)}),this.onNativeAPIResponse(function(o){return t.formatLog("onNativeAPIResponse",o)}),this.onNativeAPIResponseAsync(function(o){return t.formatLog("onNativeAPIResponseAsync",o)})}},{key:"onConnect",value:function(t){return this.on(d.CONNECTION_BROADCAST,t)}},{key:"onDisconnect",value:function(t){return this.on(d.DISCONNECTION_BROADCAST,t)}},{key:"onNativeAPIResponse",value:function(t){return this.on(d.NATIVE_API_RESPONSE,t)}},{key:"onNativeAPIResponseAsync",value:function(t){return this.on(d.NATIVE_API_RESPONSE_ASYNC,t)}},{key:"onWebAPIResponse",value:function(t){return this.on(d.WEB_API_RESPONSE,t)}},{key:"onQueryResponse",value:function(t){return this.on(d.QUERY_RESPONSE,t)}},{key:"query",value:function(t){var o=t!=null?t:"All";this.socket.emit(d.QUERY,{Entity:o})}},{key:"airtEmit",value:function(t){this.socket.emit(d.MSG,t)}},{key:"onMsg",value:function(t){this.on(d.MSG,t)}},{key:"on",value:function(t,o){var s=this;return this.socket.on(t,o),function(){s.socket.off(t,o)}}},{key:"onMsgOnce",value:function(t){this.socket.once(d.MSG,t)}},{key:"onWebAPI",value:function(){console.log("Had on Msg");var t=this;this.onMsg(function(o){var s=o.WebAPI,u=o.Entity;if(console.log("Got Msg from Node:",o),s&&t.entities.has(u)){var i=t.getEntity(u);i.applyWebAPI(o)}})}},{key:"emitAPIResponse",value:function(t){this.formatLog("emitAPIResponse: ",t),this.socket.emit(d.WEB_API_RESPONSE,t)}},{key:"onQuery",value:function(){var t=this;this.on(d.QUERY,function(o){t.config.webApiJson&&t.emitQueryResponse(Object.assign({InvokerInfo:o.InvokerInfo},t.config.webApiJson))})}},{key:"emitQueryResponse",value:function(t){this.formatLog("emitQueryResponse",t)}}]),c}(),R=l.createContext(null),W=function(n){var t=n.config,o=n.children,s=(0,l.useState)(null),u=r()(s,2),i=u[0],E=u[1],f=(0,l.useState)(t),A=r()(f,2),h=A[0],v=A[1];return(0,l.useEffect)(function(){console.log("config change"),JSON.stringify(h)!==JSON.stringify(t)&&(i&&i.socket.disconnect(),E(new C(t)),v(t))},[t]),(0,l.useEffect)(function(){return console.log("AirSocketProvider init"),E(new C(t)),v(t),function(){i&&i.socket.disconnect(),console.log("AirSocketProvider remove")}},[]),(0,g.jsx)(R.Provider,Object.assign({value:i},{children:i?o:null}))},S=e(37635),U=e.n(S),M=function(n){var t,o=(t=Object.prototype.toString.call(n).match(/\[object (.*?)\]/))===null||t===void 0?void 0:t[1];return o.toLowerCase()},D=function(n){var t="[AirtSocketIOClient Error] ".concat(n);return console.error(t)},Z=function(){function c(n,t){P()(this,c),this.name=n,this.manager=t,this.apis=new Map,this.apiStack=new Set}return _()(c,[{key:"registerAPI",value:function(t,o){var s=this;U()(t)==="object"?Object.entries(t).forEach(function(u){var i=r()(u,2),E=i[0],f=i[1];s.setAPI(E,f)}):typeof t=="string"&&o?this.setAPI(t,o):typeof t!="string"&&D("apiName should be string or object, but get ".concat(M(t)))}},{key:"unregisterAPI",value:function(t){var o=this;Array.isArray(t)?t.forEach(function(s){o.apis.delete(s)}):typeof t=="string"?o.apis.delete(t):D("apiName should be string or string[], but get".concat(M(t)))}},{key:"setAPI",value:function(t,o){if(M(o)!=="function"&&D("callback should be function, but get ".concat(M(o))),o===this.apis.get(t))return!1;t!==""?(this.manager.formatLog("registerAPI",{apiName:t,callback:o}),this.apis.set(t,o)):D("apiName is not allowed to be null")}},{key:"applyWebAPI",value:function(t){var o=this;if(!t.WebAPI){D("WebAPI is required");return}Object.entries(t.WebAPI).forEach(function(s){var u=r()(s,2),i=u[0],E=u[1],f=E.Parms,A;if(o.manager.formatLog("applyWebAPI",{apiName:i,Parms:f}),o.apis.has(i)){o.apis.get(i)(f);var h=new Date().getTime(),v=new Date().getTime();A={Entity:o.name,InvokedWebAPI:i,InvokerInfo:t.InvokerInfo,InvokedResponseCode:200,Msg:"Entity: ".concat(o.name,": WebAPI: ").concat(i,", with Params Num ").concat("1",", TimeCost: ").concat("".concat(v-h),"ms")}}else A={Entity:o.name,InvokedWebAPI:i,InvokerInfo:t.InvokerInfo,InvokedResponseCode:404,Msg:"Entity: ".concat(o.name,": WebAPI: ").concat(i,", ").concat(i," is not registered")};o.manager.emitAPIResponse(A)})}}]),c}(),a=function(){var n=(0,l.useContext)(R),t=(0,l.useMemo)(function(){var o=null;n===null&&D("useSocket must be uesed in Provider");var s=n?n.UserRole:"";return s===""&&D("config.name can not be null"),n&&n.getEntity(s)?o=n.getEntity(s):n&&(o=new Z(s,n)),o},[n]);return n&&t&&n.registerEntity(t.name,t),n&&t?{socket:n.socket,entity:n.entities,config:n.config,apis:t.apis,manager:t.manager,setAPI:t.setAPI,registerAPI:t.registerAPI,unregisterAPI:t.unregisterAPI,onConnect:n.onConnect,onDisconnect:n.onDisconnect,onQueryResponse:n.onQueryResponse,onNativeAPIResponse:n.onNativeAPIResponse,onNativeAPIResponseAsync:n.onNativeAPIResponseAsync,onWebAPIResponse:n.onWebAPIResponse,query:n.query,airtEmit:n.airtEmit,onMsg:n.onMsg,onMsgOnce:n.onMsgOnce,on:n.on}:null}},2463:function(G,I,e){e.d(I,{Z:function(){return P}});var O=e(57213),r=e.n(O),g=e(93236),l=e(62086),y=function(_){var m=_.width,d=m===void 0?"96px":m,C=_.height,R=C===void 0?"40px":C,W=_.style,S=_.content;return(0,l.jsx)("div",{className:"base-tag",style:r()({width:d,height:R},W),children:S})},P=y},97279:function(G,I,e){var O=e(57213),r=e.n(O),g=e(93236),l=e(54288),y=e(91451),P=e(79805),b=e(44901),_=e(36872),m=e(66543),d=e(73487),C=e(80509),R=e(9700),W=e(51597),S=e(79502),U=e(60996),M=e(62086);l.D([b.N,_.N,R.N,U.N,S.T,m.N,d.N,W.N,C.N]);var D=function(a){var c=a.width,n=a.height,t=a.xAxisConfig,o=a.yAxisConfig,s=a.barBorderRadius,u=s===void 0?[0,0,0,0]:s,i=a.xSourceData1,E=a.xSourceData2,f=a.legendData,A=f===void 0?["\u7535\u529B\u4EF7\u683C\u6307\u6570","\u7535\u5EA6\u7535\u4EF7"]:f,h=a.legendConfig,v=a.gridConfig,N=v===void 0?{top:"15%",right:"5%",left:"12%",bottom:"8%"}:v,K=a.barColorConfig,j=a.normalLableConfig,T=j===void 0?{}:j,L=a.barWidth,$=L===void 0?10:L,B=a.animation,Q=B===void 0?!1:B,p=(0,g.useRef)(null),x=(0,g.useRef)(null);return(0,g.useEffect)(function(){p.current&&(x.current=y.S1(p.current,void 0,{width:c,height:n}),x.current.setOption({backgroundColor:"transparent",grid:r()({},N),legend:r()({},h),animation:Q,xAxis:r()({},t),yAxis:r()({},o),series:[{type:"bar",name:h==null?void 0:h.data[0],barWidth:$,itemStyle:{normal:{label:r()({},T),color:new P.Z(1,0,0,0,K[0]),borderWidth:0,barBorderRadius:u}},data:i},(h==null?void 0:h.data.length)>1?{type:"bar",name:h==null?void 0:h.data[1],barWidth:$,itemStyle:{normal:{label:r()({},T),color:new P.Z(1,0,0,0,K[1]),borderWidth:0,barBorderRadius:u}},data:E}:{}]}))},[i,c,n,A]),(0,M.jsx)("div",{ref:p})};I.Z=D},25688:function(G,I,e){e.d(I,{Z:function(){return P}});var O=e(57213),r=e.n(O),g=e(93236),l=e(62086),y=function(_){var m=_.width,d=_.height,C=_.style;return(0,l.jsxs)("div",{className:"mutation-bar",style:{width:m,height:d},children:[(0,l.jsxs)("div",{className:"mutation-bar-content",children:[(0,l.jsx)("div",{children:"0"}),(0,l.jsx)("div",{children:"1"}),(0,l.jsx)("div",{children:"2"})]}),(0,l.jsxs)("div",{className:"mutation-bar-text",style:r()({},C),children:[(0,l.jsx)("div",{children:"\u5DEE"}),(0,l.jsx)("div",{children:"\u4F18"}),(0,l.jsx)("div",{children:"\u5DEE"})]})]})},P=y},24616:function(G,I,e){var O=e(57213),r=e.n(O),g=e(93236),l=e(54288),y=e(91451),P=e(79805),b=e(44901),_=e(36872),m=e(66543),d=e(73487),C=e(80509),R=e(9700),W=e(51597),S=e(79502),U=e(60996),M=e(30701),D=e(62086);l.D([M.N]),l.D([b.N,_.N,R.N,U.N,S.T,m.N,d.N,W.N,C.N]);var Z="transparent",a=function(n){var t=n.width,o=n.height,s=n.symbolConfig,u=s===void 0?{}:s,i=n.echartData,E=n.legendOption,f=E===void 0?{show:!1}:E,A=n.yAxesConfigs,h=n.xAxisConfigs,v=n.titles,N=v===void 0?[]:v,K=n.gridConfig,j=K===void 0?{top:"15%",right:"15%",left:"12%",bottom:"20%"}:K,T=n.barColorConfig,L=n.lineWidth,$=L===void 0?1:L,B=n.lineColor,Q=n.yAxisData1,p=n.yAxisData2,x=n.animation,Y=x===void 0?!1:x,k=(0,g.useRef)(null),V=(0,g.useRef)(null);return(0,g.useEffect)(function(){k.current&&(V.current=y.S1(k.current,void 0,{width:t,height:o}),V.current.setOption({animation:Y,backgroundColor:Z,color:B,tooltip:{trigger:"axis",backgroundColor:"rgba(13, 64, 71, 0.50)",borderColor:"rgba(143, 225, 252, 0.60)",padding:8,textStyle:{color:"#fff"}},legend:r()({},f),grid:r()({},j),xAxis:h,yAxis:A,series:[r()(r()({name:N[0],type:"line"},u),{},{lineStyle:{color:B[0],width:$},areaStyle:{normal:{color:new P.Z(0,0,0,1,T[0],!1)}},data:Q,yAxisIndex:0}),N.length>1?r()(r()({name:N[1],type:"line"},u),{},{lineStyle:{normal:{color:B[1],width:$}},areaStyle:{normal:{color:new P.Z(0,0,0,1,T[1],!1)}},data:p,yAxisIndex:1}):{}]}))},[Q,p]),(0,D.jsx)("div",{ref:k})};I.Z=a},24828:function(G,I,e){var O=e(57213),r=e.n(O),g=e(93236),l=e(54288),y=e(91451),P=e(79805),b=e(44901),_=e(36872),m=e(66543),d=e(73487),C=e(80509),R=e(9700),W=e(51597),S=e(79502),U=e(60996),M=e(62086);l.D([b.N,_.N,R.N,U.N,S.T,m.N,d.N,W.N,C.N]);var D=function(a){var c=a.width,n=a.height,t=a.yAxisData1,o=a.yAxisData2,s=a.barBorderRadius,u=s===void 0?[0,0,0,0]:s,i=a.barWidth,E=i===void 0?10:i,f=a.tooltip,A=f===void 0?!0:f,h=a.grid,v=a.legendConfig,N=a.yAxisConfig,K=a.xAxisConfig,j=a.barColorConfig,T=a.normalLableConfig,L=a.barGap,$=L===void 0?"50%":L,B=a.animation,Q=B===void 0?!1:B,p=(0,g.useRef)(null),x=(0,g.useRef)(null);return(0,g.useEffect)(function(){p.current&&(x.current=y.S1(p.current,void 0,{width:c,height:n}),x.current.setOption({backgroundColor:"transparent",tooltip:A,grid:h,legend:r()({},v),animation:Q,xAxis:r()({},K),yAxis:r()({},N),series:[{name:v==null?void 0:v.data[0],type:"bar",data:t,barWidth:E,barGap:$,itemStyle:{normal:{label:r()({},T[0]),color:new P.Z(0,0,0,1,j[0]),barBorderRadius:u}},symbolPosition:"end"},(v==null?void 0:v.data.length)>1?{name:v==null?void 0:v.data[1],type:"bar",data:o,barWidth:E,itemStyle:{normal:{label:r()({},T[1]),color:new P.Z(0,0,0,1,j[1]),barBorderRadius:u}},symbolPosition:"end"}:{}]}))},[t,o]),(0,M.jsx)("div",{ref:p})};I.Z=D}}]);
